# Student Database Management System

A Node.js command-line application for managing student records in a PostgreSQL database. This program provides CRUD (Create, Read, Update, Delete) operations for student information.

## Prerequisites

Before running this program, ensure you have the following installed:

- **Node.js** (version 14 or higher)
- **PostgreSQL** (version 12 or higher)
- **npm** (comes with Node.js)

## Installation

1. Clone or download this repository
2. Navigate to the project directory:
   ```bash
   cd COMP3005-A3
   ```

3. Install the required dependencies:
   ```bash
   npm install
   ```

## Database Setup

1. Make sure PostgreSQL is running on your system

2. Create a database (if you haven't already):
   ```sql
   CREATE DATABASE your_database_name;
   ```

3. Run the schema file to create the `students` table and insert sample data:
   ```bash
   psql -U postgres -d your_database_name -f db/schema.sql
   ```
   
   Or if you're using a different user:
   ```bash
   psql -U your_username -d your_database_name -f db/schema.sql
   ```

## Configuration

Create a `.env` file in the root directory of the project with your database connection details:

### Option 1: Using Individual Connection Parameters
```env
PGHOST=localhost
PGPORT=5432
PGUSER=postgres
PGPASSWORD=your_password
PGDATABASE=your_database_name
```

### Option 2: Using DATABASE_URL (for cloud deployments)
```env
DATABASE_URL=postgresql://username:password@host:port/database
PGSSL=true
```

**Note:** If you don't create a `.env` file, the program will use default values:
- Host: `localhost`
- Port: `5432`
- User: `postgres`
- Password: (empty)
- Database: `postgres`

## How to Execute

### Method 1: Direct Node.js Execution

Run the program directly using Node.js:

```bash
node src/index.js <command> [arguments]
```

### Method 2: Using npm Scripts

You can also use the predefined npm scripts:

```bash
npm run list
npm run add
npm run update
npm run delete
```

## Available Commands

### List All Students
Display all students in the database in a table format.

```bash
node src/index.js list
```

Or:
```bash
npm run list
```

### Add a New Student
Add a new student to the database.

```bash
node src/index.js add "<first_name>" "<last_name>" "<email>" "<YYYY-MM-DD>"
```

**Example:**
```bash
node src/index.js add "Alice" "Wonder" "alice@example.com" "2024-09-01"
```

Or:
```bash
npm run add "Alice" "Wonder" "alice@example.com" "2024-09-01"
```

### Update Student Email
Update the email address of an existing student.

```bash
node src/index.js update <student_id> "<new_email>"
```

**Example:**
```bash
node src/index.js update 1 "alice.wonder@example.com"
```

Or:
```bash
npm run update 1 "alice.wonder@example.com"
```

### Delete a Student
Delete a student from the database by their student ID.

```bash
node src/index.js delete <student_id>
```

**Example:**
```bash
node src/index.js delete 1
```

Or:
```bash
npm run delete 1
```

### Display Help
If you run the program without a command or with an invalid command, it will display the available commands:

```bash
node src/index.js
```

## Example Usage

1. **List all students:**
   ```bash
   node src/index.js list
   ```

2. **Add a new student:**
   ```bash
   node src/index.js add "Bob" "Johnson" "bob.johnson@example.com" "2024-09-15"
   ```

3. **Update a student's email:**
   ```bash
   node src/index.js update 4 "bob.j@example.com"
   ```

4. **Delete a student:**
   ```bash
   node src/index.js delete 4
   ```

## Error Handling

The program handles common database errors:

- **Duplicate Email Error (23505):** Occurs when trying to add a student with an email that already exists
- **Invalid Input Syntax (22P02):** Occurs when providing invalid data types (e.g., non-numeric student ID or invalid date format)
- **Other Errors:** Displays the error message for any other issues

## Video Demonstration

A video demonstration of this application is available at: **https://youtu.be/3TglAtMv-lA**

The video demonstrates:
- Database setup with the provided schema and initial data
- Execution of all four CRUD operations (getAllStudents, addStudent, updateStudentEmail, deleteStudent)
- Verification of operations in pgAdmin showing the effects on the database

## Notes

- The `student_id` is auto-generated by the database and cannot be manually set
- Email addresses must be unique (enforced by database constraint)
- Date format must be `YYYY-MM-DD` (e.g., `2024-09-01`)
- The program automatically closes the database connection after each command execution

